---
title: Threshold
description: Learn how to fine-tune the amount of visual change between snapshots before they get marked as changes
sidebar: { order: 14, label: Threshold for changes }
---

import ParamsCallout from "../../components/ParamsCallout.astro";

import IntegrationSnippets from "../../components/IntegrationSnippets.astro";

# Threshold for changes

The `diffThreshold` configuration option allows you to fine-tune the threshold for visual change between snapshots before Chromatic flags them. Sometimes, you need assurance to the sub-pixel; other times, you want to skip visual noise generated by non-deterministic rendering, such as anti-aliasing.

## Setting the threshold

Diff threshold values closer to `0` are more sensitive, but more likely to have false positives, while values closer to `1` are less sensitive, but less likely to have false positives. Chromatic's default threshold is `.063`, which balances high visual accuracy with low false positives (for example, from artifacts like anti-aliasing).

If you need to customize how Chromatic identifies visual changes in your UI, add the `diffThreshold` configuration option to your tests. For example:

{/* prettier-ignore-start */}

<IntegrationSnippets>
  <Fragment slot="storybook">
    ```ts title="src/components/UserAccount.stories.ts|tsx"
    // Adjust this import to match your framework (e.g., nextjs, vue3-vite)
    import type { Meta, StoryObj } from "@storybook/your-framework";

    /*
     * Replace the storybook/test import with `@storybook/test` and adjust the stories accordingly if you're not using Storybook 9.0.
     * Refer to the Storybook documentation for the correct package and imports for earlier versions.
    */
    import { expect } from "storybook/test";

    import { UserAccount } from "./UserAccount";

    const meta = {
      component: UserAccount,
      title: "UserAccount",
      parameters: {
        // Sets the threshold for 0.2 at the component level for all stories.
        chromatic: { diffThreshold: 0.2 },
      },
    } satisfies Meta<typeof UserAccount>;

    export default meta;
    type Story = StoryObj<typeof meta>;

    export const Default: Story = {
      play: async ({ canvas }) => {
        await expect(canvas.getByText("Welcome, username")).toBeInTheDocument();
      },
    };
    ```
    <ParamsCallout name="diffThreshold" integration="storybook" />
  </Fragment>
  <Fragment slot="playwright">
    ```ts title="tests/UserProfile.spec.js|ts"
    import { test, expect } from "@chromatic-com/playwright";

    test.describe("User Profile Page", () => {
      // Sets the threshold for 0.2 for this test.
      test.use({ diffThreshold: 0.2 });

      test("Successfully loads the user information ", async ({ page }) => {
        await page.goto("/profile");
        await expect(page.getByText("Welcome, username")).toBeVisible();
      });
    });
    ```
    <ParamsCallout name="diffThreshold" integration="playwright" />
  </Fragment>
  <Fragment slot="cypress">
    ```ts title="cypress/e2e/UserProfile.cy.js|ts"
    describe("User Profile Page", () => {
       // Sets the threshold for 0.2 for this test.
      it("Successfully authenticates user", { env: { diffThreshold: 0.2 } }, () => {
        cy.visit("/profile");
        cy.get("span").contains("Welcome, username");
      });
    });
    ```
    <ParamsCallout name="diffThreshold" integration="cypress" />
  </Fragment>
</IntegrationSnippets>

{/* prettier-ignore-end */}

Adjusting the `diffThreshold` configuration option allows Chromatic to detect subtle visual changes within your UI when snapshotted. While accurate for most common scenarios, it can lead to an inconsistent UI test. For example, setting the parameter to a value of `0.8` can be enough to prevent Chromatic from accurately detecting changes (e.g., positioning).

If you're unsure which value will be enough, use our [**interactive diff tool**](https://6262c53f521620003ac2ff49-ukmsdlppcb.chromatic.com/?path=/story/stories-diff-threshold-check--test-yours-out) that allows you to preview in real-time how adjusting the option impacts your UI tests.

### Anti-aliasing

By default, Chromatic detects anti-aliased pixels and ignores them to prevent false positives. The `diffIncludeAntiAliasing` configuration option allows you to override this behavior when Chromatic does not flag a single pixel change but should.

To enable this feature and allow Chromatic to automatically detect anti-aliased pixels, adjust your tests to include the `diffIncludeAntiAliasing` option. For example:

{/* prettier-ignore-start */}

<IntegrationSnippets>
  <Fragment slot="storybook">
    ```ts title="src/components/UserAccount.stories.ts|tsx"
    // Adjust this import to match your framework (e.g., nextjs, vue3-vite)
    import type { Meta, StoryObj } from "@storybook/your-framework";

    /*
     * Replace the storybook/test import with `@storybook/test` and adjust the stories accordingly if you're not using Storybook 9.0.
     * Refer to the Storybook documentation for the correct package and imports for earlier versions.
    */
    import { expect } from "storybook/test";

    import { UserAccount } from "./UserAccount";

    const meta = {
      component: UserAccount,
      title: "UserAccount",
      parameters: {
        // Configures the component to include anti-aliasing in the diff calculation.
        chromatic: { diffIncludeAntiAliasing: true },
      },
    } satisfies Meta<typeof UserAccount>;

    export default meta;
    type Story = StoryObj<typeof meta>;

    export const Default: Story = {
      play: async ({ canvas }) => {
        await expect(canvas.getByText("Welcome, username")).toBeInTheDocument();
      },
    };
    ```
    <ParamsCallout name="diffIncludeAntiAliasing" integration="storybook" />
  </Fragment>
  <Fragment slot="playwright">
    ```ts title="tests/UserProfile.spec.js|ts"
    import { test, expect } from "@chromatic-com/playwright";

    test.describe("User Profile Page", () => {
      // Configures this to include anti-aliasing in the diff calculation.
      test.use({ diffIncludeAntiAliasing: true });

      test("Successfully loads the user information ", async ({ page }) => {
        await page.goto("/profile");
        await expect(page.getByText("Welcome, username")).toBeVisible();
      });
    });
    ```
    <ParamsCallout name="diffIncludeAntiAliasing" integration="playwright" />
  </Fragment>
  <Fragment slot="cypress">
    ```ts title="cypress/e2e/UserProfile.cy.js|ts"
    describe("User Profile Page", () => {
      // Configures this to include anti-aliasing in the diff calculation.
      it("Successfully loads the user information", { env: { diffIncludeAntiAliasing: true } }, () => {
        cy.visit("/profile");
        cy.get("span").contains("Welcome, username");
      });
    });
    ```
    <ParamsCallout name="diffIncludeAntiAliasing" integration="cypress" />
  </Fragment>
</IntegrationSnippets>

{/* prettier-ignore-end */}

## Troubleshooting

<details>
<summary>Why weren't diffs found when a color or background changed?</summary>

Chromatic uses a threshold to determine how much must change between snapshots before they get flagged as visual changes. This prevents false positives due to anti-aliasing and other non-deterministic rendering artifacts.

However, our default threshold may miss subtle changes, such as nuanced changes to a background's shade of gray. In this case, you may want to adjust the `diffThreshold` to be more accurate (lower value).

Find the suitable threshold for your UI using our [**interactive diff tool**](https://6262c53f521620003ac2ff49-ukmsdlppcb.chromatic.com/?path=/story/stories-diff-threshold-check--test-yours-out).

</details>

<details>
<summary>What is the threshold?</summary>

The threshold measures how much color difference Chromatic will tolerate before flagging two snapshots as “different. It measures the color distance in a 3D color space (YIQ).
Chromatic compares the color at the same (x, y) position in both snapshots and checks how far apart they are in color space. Think of it like this:

A **low threshold** (e.g., `0.0005`) means almost identical colors will still be flagged as changed. This is great for pixel-perfect checks.

A **high threshold** (e.g., `0.63`) means Chromatic tolerates larger color differences — it’ll only flag major visual changes.

Every screen has a different pixel density (DPI/PPI) and color gamut, so there’s no **“1 pixel = 1 threshold”** relationship.

</details>
