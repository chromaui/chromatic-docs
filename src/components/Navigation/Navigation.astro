---
import { type CollectionEntry } from "astro:content";
import Search from "../Search.astro";
import { Support } from "../Support";
import { SideNav } from "./SideNav";
import { Container } from "./styles";
import { DropdownNav } from "./DropdownNav";
import { transformNavGroups } from "./transform-nav-groups";

interface Props {
  url?: string;
  navItems: {
    title: string;
    items: (
      | CollectionEntry<"overview">
      | CollectionEntry<"storybook">
      | CollectionEntry<"playwright">
      | CollectionEntry<"cypress">
      | CollectionEntry<"configuration">
      | CollectionEntry<"modes">
      | CollectionEntry<"snapshot">
      | CollectionEntry<"snapshotOptions">
      | CollectionEntry<"turbosnap">
      | CollectionEntry<"collaborate">
      | CollectionEntry<"plugins">
      | CollectionEntry<"ci">
      | CollectionEntry<"account">
      | CollectionEntry<"guides">
      | CollectionEntry<"troubleshooting">
    )[];
    defaultOpen?: boolean;
    timeline?: boolean;
  }[];
}

const { navItems, url } = Astro.props;

const navGroups = navItems ? transformNavGroups(navItems) : [];
---

<Container>
  <Search />
  <DropdownNav client:only="react" groups={navGroups as any} url={url} />
  <SideNav client:load sidebarItems={navGroups} url={url} />
  <Support client:load />
</Container>
